<!DOCTYPE html>
<html>
<head>
    <title>Glossary Editor</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h1>Chinese ↔ English Glossary</h1>

    <!-- Search + Export Row -->
    <div style="display: flex; align-items: center; gap: 1em; margin-bottom: 1em;">
        <!-- Search form -->
        <form method="get" action="/glossary/" style="display: flex; gap: 0.5em; flex-grow: 1;">
            <input type="hidden" name="sort_by" value="{{ sort_by }}">
            <input type="hidden" name="sort_dir" value="{{ sort_dir }}">
            <input type="text" name="q" placeholder="Search..." value="{{ q }}" style="flex-grow: 1;">
            <button type="submit">Search</button>
        </form>

        <!-- Export CSV button -->
        <form method="get" action="/glossary/export">
            <button type="submit">Export CSV</button>
        </form>
    </div>
    
    <!-- Add term form -->
    <h2>Add Term</h2>
    <form method="post" action="/glossary/">
        <input type="text" name="chinese" placeholder="Chinese" required>
        <input type="text" name="english" placeholder="English" required>
        <input type="text" name="notes" placeholder="Notes">
        <button type="submit">Add</button>
    </form>

    <!-- Glossary table -->
    <h2>Glossary</h2>
    <table id="glossaryTable">
        <thead>
        <tr>
            <th data-sort="alpha">
            Chinese
            {% if sort_by == 'alpha' %}
                {{ '↑' if sort_dir == 'asc' else '↓' }}
            {% endif %}
            </th>
            <th data-sort="length">
            English (by length)
            {% if sort_by == 'length' %}
                {{ '↑' if sort_dir == 'asc' else '↓' }}
            {% endif %}
            </th>
            <th>Notes</th>
            <th>Actions</th>
        </tr>
        </thead>

        <tbody>
            {% for row in rows %}
            <tr data-id="{{ row['id'] }}" 
                data-chinese="{{ row['chinese'] | e }}" 
                data-english="{{ row['english'] | e }}" 
                data-notes="{{ row['notes'] | e }}">
                <td class="chinese">{{ row['chinese'] }}</td>
                <td class="english">{{ row['english'] }}</td>
                <td class="notes">{{ row['notes'] }}</td>
                <td>
                    <button type="button" class="editBtn">Edit</button>
                    <button type="button" class="deleteBtn">Delete</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Pagination -->
    <div class="pagination" style="margin-top: 1em;">
        {% if page > 1 %}
            <a class="button"
            href="/glossary/?q={{ q }}&page={{ page - 1 }}&limit={{ limit }}&sort_by={{ sort_by }}&sort_dir={{ sort_dir }}">
            Back
            </a>
        {% endif %}
        {% if page < total_pages %}
            <a class="button"
            href="/glossary/?q={{ q }}&page={{ page + 1 }}&limit={{ limit }}&sort_by={{ sort_by }}&sort_dir={{ sort_dir }}">
            Next
            </a>
        {% endif %}
        <span>Page {{ page }} of {{ total_pages }}</span>
    </div>

</body>
<script src="/static/glossary.js"></script>
</html>
